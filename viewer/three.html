<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>My first three.js app</title>
		<style>
			body { margin: 0;
            }
			canvas {
                width: 100%;
                height: 100%;
                background: -moz-linear-gradient(top,  lightskyblue 0%, midnightblue 100%); /* FF3.6-15 */
                background: -webkit-linear-gradient(top,  lightskyblue 0%,midnightblue 100%); /* Chrome10-25,Safari5.1-6 */
                background: linear-gradient(to bottom,  lightskyblue 0%,midnightblue 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
            }


		</style>
	</head>
	<body>
		<script src="js/three.js"></script>
		<script src="js/OrbitControls.js"></script>
        <!-- <script src="js/OBJLoader.js"></script> -->
        <script src="js/dat.gui.min.js"></script>
        <script src="js/split.min.js"></script>
		<script src="js/msgpack.min.js"></script>

        <div id="scene-controls-container" class="split split-horizontal">
            <ul id="scene-controls">
            </ul>
        </div>
        <div id="threejs-pane" class="split split-horizontal"></div>

        <script src="js/viewertree.js"></script>
        <script>
            var tree = {visible: true, name: "scene"};
            tree.children = [{visible: true, name: "c1"}, {visible: true, name: "c2"}];
            tree.children[0].children = [{visible: true, name: "foo"}]
            tree.children[1].children = [];

            function create_element(type, parent, attrs) {
                let element = document.createElement(type);
                if (attrs !== undefined) {
                    for (let attr of Object.keys(attrs)) {
                        element.setAttribute(attr, attrs[attr]);
                    }
                }
                if (parent !== undefined && parent !== null) {
                    parent.append(element);
                }
                return element;
            }

            function create_text(text, parent) {
                let element = document.createTextNode(text);
                if (parent !== undefined) {
                    parent.append(element);
                }
                return element;
            }


            function create_options(node, element) {
                let li = create_element("li", element, {class: "accordion expanded"});
                let expander = create_element("div", li, {class: "expansion-control"});
                expander.addEventListener("click", function() {
                    console.log(li);
                    li.classList.toggle("expanded");
                });
                let name = create_text(node.name, create_element("span", li));
                let visible = create_element("input", li, {type: "checkbox"});
                let ul = create_element("ul", li)
                if ("children" in node) {
                    for (let child of node.children) {
                        let li = create_element("li", ul);
                        create_options(child, li);
                    }
                }
            }
            create_options(tree, document.getElementById("scene-controls"));

            Split(['#scene-controls-container', '#threejs-pane'], {
                sizes: [25, 75],
                onDrag: function() {
                    set_3d_pane_size(threejs_pane.offsetWidth, threejs_pane.offsetHeight);
                },
                onDragEnd: function () {
                    set_3d_pane_size(threejs_pane.offsetWidth, threejs_pane.offsetHeight);
                }
            });
        </script>

         <style>
            body {
                margin: 0;
            }

              html, body {
            height: 100%;
          }

          body {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
          }

          .split {
            -webkit-box-sizing: border-box;
               -moz-box-sizing: border-box;
                    box-sizing: border-box;

            overflow-y: auto;
            overflow-x: hidden;
          }

          .content {
            background-color: #fff;
          }

          .gutter {
            background-color: #ccc;
            background-repeat: no-repeat;
            background-position: 50%;
          }

          .gutter.gutter-horizontal {
            cursor: col-resize;
          }

          .split.split-horizontal, .gutter.gutter-horizontal {
            height: 100%;
            float: left;
          }

            .tree-controls ul {
                list-style: none;
            }

            .expansion-control {
                float: left;
            }

            .accordion > .expansion-control::after {
                content: '\25b6';
            }

            .expanded > .expansion-control::after {
                content: '\25bc';
            }

            .accordion > ul {
                overflow: hidden;
                max-height: 0;
            }

            .expanded > ul {
                max-height: 100%;
            }


        </style>
	</body>
</html>
